<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="800" viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <title>Enterprise Loan Management - Microservices Architecture</title>
  
  <!-- Background -->
  <rect width="1200" height="800" fill="#FAFAFA"/>
  
  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#333">
    Enterprise Loan Management System - Microservices Architecture
  </text>
  <text x="600" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#666">
    Gradle 9.0+ | Redis API Gateway | Circuit Breaker | OWASP Security | SAGA Patterns
  </text>
  
  <!-- Client Layer -->
  <g id="client-layer">
    <rect x="50" y="80" width="150" height="60" rx="5" fill="#FFE0B2" stroke="#333" stroke-width="1"/>
    <text x="125" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Web Frontend</text>
    <text x="125" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">React/Angular</text>
    
    <rect x="220" y="80" width="150" height="60" rx="5" fill="#FFE0B2" stroke="#333" stroke-width="1"/>
    <text x="295" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Mobile App</text>
    <text x="295" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">iOS/Android</text>
    
    <rect x="390" y="80" width="150" height="60" rx="5" fill="#FFE0B2" stroke="#333" stroke-width="1"/>
    <text x="465" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Third Party</text>
    <text x="465" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="10">OpenBanking</text>
  </g>
  
  <!-- API Gateway Layer -->
  <g id="gateway-layer">
    <rect x="50" y="170" width="490" height="80" rx="5" fill="#E1F5FE" stroke="#333" stroke-width="2"/>
    <text x="295" y="190" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Redis-Integrated API Gateway</text>
    <text x="100" y="210" font-family="Arial, sans-serif" font-size="10">• Circuit Breaker Patterns</text>
    <text x="100" y="225" font-family="Arial, sans-serif" font-size="10">• Rate Limiting (Redis)</text>
    <text x="100" y="240" font-family="Arial, sans-serif" font-size="10">• Token Management</text>
    <text x="300" y="210" font-family="Arial, sans-serif" font-size="10">• OWASP Top 10 Security</text>
    <text x="300" y="225" font-family="Arial, sans-serif" font-size="10">• FAPI Compliance</text>
    <text x="300" y="240" font-family="Arial, sans-serif" font-size="10">• Load Balancing</text>
  </g>
  
  <!-- Security Layer -->
  <g id="security-layer">
    <rect x="570" y="80" width="200" height="170" rx="5" fill="#F3E5F5" stroke="#333" stroke-width="1"/>
    <text x="670" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">OWASP Security Filters</text>
    <text x="580" y="120" font-family="Arial, sans-serif" font-size="9">• SQL Injection Protection</text>
    <text x="580" y="135" font-family="Arial, sans-serif" font-size="9">• XSS Prevention</text>
    <text x="580" y="150" font-family="Arial, sans-serif" font-size="9">• CSRF Protection</text>
    <text x="580" y="165" font-family="Arial, sans-serif" font-size="9">• Security Headers</text>
    <text x="580" y="180" font-family="Arial, sans-serif" font-size="9">• Authentication</text>
    <text x="580" y="195" font-family="Arial, sans-serif" font-size="9">• Authorization</text>
    
    <rect x="580" y="210" width="180" height="35" rx="3" fill="#F8BBD9" stroke="#333" stroke-width="1"/>
    <text x="670" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold">OAuth2 JWT Service</text>
    <text x="670" y="240" text-anchor="middle" font-family="Arial, sans-serif" font-size="8">FAPI Authentication</text>
  </g>
  
  <!-- Microservices Layer -->
  <g id="microservices-layer">
    <!-- Customer Service -->
    <rect x="50" y="280" width="200" height="120" rx="5" fill="#C8E6C9" stroke="#333" stroke-width="2"/>
    <text x="150" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Customer Management</text>
    <text x="60" y="320" font-family="Arial, sans-serif" font-size="10">Port: 8081</text>
    <text x="60" y="335" font-family="Arial, sans-serif" font-size="10">Database: customer_db</text>
    <text x="60" y="355" font-family="Arial, sans-serif" font-size="9">• Credit Management</text>
    <text x="60" y="370" font-family="Arial, sans-serif" font-size="9">• Account Status</text>
    <text x="60" y="385" font-family="Arial, sans-serif" font-size="9">• Profile Validation</text>
    
    <!-- Loan Service -->
    <rect x="270" y="280" width="200" height="120" rx="5" fill="#FFCDD2" stroke="#333" stroke-width="2"/>
    <text x="370" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Loan Origination</text>
    <text x="280" y="320" font-family="Arial, sans-serif" font-size="10">Port: 8082</text>
    <text x="280" y="335" font-family="Arial, sans-serif" font-size="10">Database: loan_db</text>
    <text x="280" y="355" font-family="Arial, sans-serif" font-size="9">• Business Rules (6,9,12,24)</text>
    <text x="280" y="370" font-family="Arial, sans-serif" font-size="9">• Interest Rate (0.1-0.5%)</text>
    <text x="280" y="385" font-family="Arial, sans-serif" font-size="9">• Installment Calculation</text>
    
    <!-- Payment Service -->
    <rect x="490" y="280" width="200" height="120" rx="5" fill="#DCEDC8" stroke="#333" stroke-width="2"/>
    <text x="590" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Payment Processing</text>
    <text x="500" y="320" font-family="Arial, sans-serif" font-size="10">Port: 8083</text>
    <text x="500" y="335" font-family="Arial, sans-serif" font-size="10">Database: payment_db</text>
    <text x="500" y="355" font-family="Arial, sans-serif" font-size="9">• Payment Distribution</text>
    <text x="500" y="370" font-family="Arial, sans-serif" font-size="9">• Discount/Penalty (0.001)</text>
    <text x="500" y="385" font-family="Arial, sans-serif" font-size="9">• Multi-installment Support</text>
  </g>
  
  <!-- SAGA Orchestration Layer -->
  <g id="saga-layer">
    <rect x="720" y="280" width="200" height="120" rx="5" fill="#FFF3E0" stroke="#333" stroke-width="2"/>
    <text x="820" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">SAGA Orchestration</text>
    <text x="730" y="320" font-family="Arial, sans-serif" font-size="9">Loan Creation SAGA:</text>
    <text x="730" y="335" font-family="Arial, sans-serif" font-size="8">• Customer Validation</text>
    <text x="730" y="350" font-family="Arial, sans-serif" font-size="8">• Credit Reservation</text>
    <text x="730" y="365" font-family="Arial, sans-serif" font-size="8">• Loan Creation</text>
    <text x="730" y="380" font-family="Arial, sans-serif" font-size="8">• Installment Generation</text>
    <text x="730" y="395" font-family="Arial, sans-serif" font-size="8">• Compensation Handling</text>
  </g>
  
  <!-- Event Streaming Layer -->
  <g id="event-layer">
    <rect x="50" y="430" width="640" height="60" rx="5" fill="#E0E0E0" stroke="#333" stroke-width="1"/>
    <text x="370" y="450" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Apache Kafka - Event Streaming</text>
    <text x="60" y="470" font-family="Arial, sans-serif" font-size="9">Topics: customer-events, loan-events, payment-events, credit-events, saga-events</text>
    <text x="60" y="485" font-family="Arial, sans-serif" font-size="9">Features: Event sourcing, SAGA coordination, Compensation workflows</text>
  </g>
  
  <!-- Data Layer -->
  <g id="data-layer">
    <!-- Customer DB -->
    <rect x="50" y="520" width="150" height="80" rx="5" fill="#E8F5E8" stroke="#333" stroke-width="1"/>
    <text x="125" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Customer DB</text>
    <text x="60" y="555" font-family="Arial, sans-serif" font-size="8">customer_db schema</text>
    <text x="60" y="570" font-family="Arial, sans-serif" font-size="8">• customers</text>
    <text x="60" y="585" font-family="Arial, sans-serif" font-size="8">• credit_reservations</text>
    
    <!-- Loan DB -->
    <rect x="220" y="520" width="150" height="80" rx="5" fill="#FFE8E8" stroke="#333" stroke-width="1"/>
    <text x="295" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Loan DB</text>
    <text x="230" y="555" font-family="Arial, sans-serif" font-size="8">loan_db schema</text>
    <text x="230" y="570" font-family="Arial, sans-serif" font-size="8">• loans</text>
    <text x="230" y="585" font-family="Arial, sans-serif" font-size="8">• loan_installments</text>
    
    <!-- Payment DB -->
    <rect x="390" y="520" width="150" height="80" rx="5" fill="#E8F8E8" stroke="#333" stroke-width="1"/>
    <text x="465" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Payment DB</text>
    <text x="400" y="555" font-family="Arial, sans-serif" font-size="8">payment_db schema</text>
    <text x="400" y="570" font-family="Arial, sans-serif" font-size="8">• payments</text>
    <text x="400" y="585" font-family="Arial, sans-serif" font-size="8">• payment_installments</text>
    
    <!-- Gateway DB -->
    <rect x="560" y="520" width="150" height="80" rx="5" fill="#F0F0F0" stroke="#333" stroke-width="1"/>
    <text x="635" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Gateway DB</text>
    <text x="570" y="555" font-family="Arial, sans-serif" font-size="8">banking_gateway</text>
    <text x="570" y="570" font-family="Arial, sans-serif" font-size="8">• saga_states</text>
    <text x="570" y="585" font-family="Arial, sans-serif" font-size="8">• audit_logs</text>
  </g>
  
  <!-- Cache Layer -->
  <g id="cache-layer">
    <rect x="750" y="520" width="180" height="80" rx="5" fill="#FFE0E0" stroke="#333" stroke-width="1"/>
    <text x="840" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Redis ElastiCache</text>
    <text x="760" y="555" font-family="Arial, sans-serif" font-size="8">• Token Cache</text>
    <text x="760" y="570" font-family="Arial, sans-serif" font-size="8">• Rate Limiting</text>
    <text x="760" y="585" font-family="Arial, sans-serif" font-size="8">• Circuit Breaker State</text>
  </g>
  
  <!-- Monitoring Layer -->
  <g id="monitoring-layer">
    <rect x="50" y="630" width="200" height="50" rx="5" fill="#E8E8FF" stroke="#333" stroke-width="1"/>
    <text x="150" y="650" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Monitoring</text>
    <text x="60" y="665" font-family="Arial, sans-serif" font-size="8">Prometheus • Grafana • Health Checks</text>
  </g>
  
  <!-- Connection Lines -->
  <g id="connections" stroke="#2196F3" stroke-width="2" fill="none">
    <!-- Client to Gateway -->
    <line x1="125" y1="140" x2="200" y2="170"/>
    <line x1="295" y1="140" x2="295" y2="170"/>
    <line x1="465" y1="140" x2="400" y2="170"/>
    
    <!-- Gateway to Security -->
    <line x1="540" y1="210" x2="570" y2="180"/>
    
    <!-- Gateway to Services -->
    <line x1="150" y1="250" x2="150" y2="280"/>
    <line x1="370" y1="250" x2="370" y2="280"/>
    <line x1="590" y1="250" x2="590" y2="280"/>
    
    <!-- Services to Databases -->
    <line x1="150" y1="400" x2="125" y2="520"/>
    <line x1="370" y1="400" x2="295" y2="520"/>
    <line x1="590" y1="400" x2="465" y2="520"/>
    
    <!-- SAGA to Gateway DB -->
    <line x1="820" y1="400" x2="635" y2="520"/>
    
    <!-- Services to Event Layer -->
    <line x1="150" y1="400" x2="200" y2="430"/>
    <line x1="370" y1="400" x2="370" y2="430"/>
    <line x1="590" y1="400" x2="520" y2="430"/>
    
    <!-- Event to SAGA -->
    <line x1="690" y1="460" x2="750" y2="340"/>
  </g>
  
  <!-- Key Features Box -->
  <g id="features">
    <rect x="950" y="80" width="230" height="300" rx="5" fill="#F9F9F9" stroke="#333" stroke-width="1"/>
    <text x="1065" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Key Features</text>
    
    <text x="960" y="125" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Circuit Breaker:</text>
    <text x="960" y="140" font-family="Arial, sans-serif" font-size="8">• 100 request sliding window</text>
    <text x="960" y="155" font-family="Arial, sans-serif" font-size="8">• 50% failure threshold</text>
    <text x="960" y="170" font-family="Arial, sans-serif" font-size="8">• 30s wait duration</text>
    
    <text x="960" y="190" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Rate Limiting:</text>
    <text x="960" y="205" font-family="Arial, sans-serif" font-size="8">• 1000 req/min API</text>
    <text x="960" y="220" font-family="Arial, sans-serif" font-size="8">• 10 req/min Auth</text>
    <text x="960" y="235" font-family="Arial, sans-serif" font-size="8">• Redis-backed tracking</text>
    
    <text x="960" y="255" font-family="Arial, sans-serif" font-size="10" font-weight="bold">SAGA Workflow:</text>
    <text x="960" y="270" font-family="Arial, sans-serif" font-size="8">• Distributed transactions</text>
    <text x="960" y="285" font-family="Arial, sans-serif" font-size="8">• Automatic compensation</text>
    <text x="960" y="300" font-family="Arial, sans-serif" font-size="8">• Event-driven rollback</text>
    <text x="960" y="315" font-family="Arial, sans-serif" font-size="8">• 5-minute timeout</text>
    
    <text x="960" y="335" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Performance:</text>
    <text x="960" y="350" font-family="Arial, sans-serif" font-size="8">• Java 21 Virtual Threads</text>
    <text x="960" y="365" font-family="Arial, sans-serif" font-size="8">• Sub-40ms response time</text>
  </g>
</svg>