@startuml Enterprise Loan Management System - System Context (Java 21)
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Context.puml

LAYOUT_WITH_LEGEND()

title Enterprise Loan Management System - System Context Diagram (Java 21 + FAPI 2.0)

' Main System
System(loan_system, "Enterprise Loan Management System", "Java 21 hexagonal architecture with Spring Boot 3.4.3, FAPI 2.0 compliance, Zero Trust security, and AI-powered banking operations")

' People
Person(customer, "Bank Customer", "Individual or business customer applying for loans and managing payments")
Person(loan_officer, "Loan Officer", "Bank employee who reviews and processes loan applications")
Person(admin, "System Administrator", "IT personnel managing the system configuration and monitoring")
Person(compliance_officer, "Compliance Officer", "Ensures regulatory compliance and audit trails")

' External Systems - Core Banking
System_Ext(core_banking, "Core Banking System", "Legacy banking system containing customer accounts and transaction history")
System_Ext(credit_bureau, "Credit Bureau", "External credit scoring and history verification service")
System_Ext(payment_gateway, "Payment Gateway", "External payment processing system")
System_Ext(fraud_detection, "Fraud Detection System", "Real-time fraud monitoring and prevention")

' External Systems - AI & Analytics
System_Ext(openai, "OpenAI API", "AI/ML services for natural language processing and banking assistance")
System_Ext(spring_ai, "Spring AI Framework", "AI integration framework for banking domain context")
System_Ext(analytics_platform, "Analytics Platform", "Business intelligence and reporting system")
System_Ext(ml_platform, "ML Platform", "Machine learning models for fraud detection and anomaly detection")

' External Systems - Compliance & Regulatory
System_Ext(regulatory_reporting, "Regulatory Reporting", "Government and regulatory body reporting systems")
System_Ext(audit_system, "Audit System", "Internal and external audit trail management")
System_Ext(kyc_system, "KYC/AML System", "Know Your Customer and Anti-Money Laundering verification")

' External Systems - Infrastructure
System_Ext(notification_service, "Notification Service", "Email, SMS, and push notification delivery")
System_Ext(document_management, "Document Management", "Digital document storage and retrieval system")
System_Ext(keycloak, "Keycloak Identity Provider", "OAuth 2.1 and FAPI 2.0 compliant identity management with DPoP support")
System_Ext(ldap, "LDAP Directory", "Enterprise directory service for user authentication and authorization")

' External Systems - Monitoring & Operations
System_Ext(prometheus, "Prometheus", "Metrics collection and monitoring")
System_Ext(grafana, "Grafana", "Metrics visualization and alerting dashboards")
System_Ext(elk_stack, "ELK Stack", "Centralized logging with Elasticsearch, Logstash, and Kibana")
System_Ext(backup_system, "Backup System", "Data backup and disaster recovery")
System_Ext(istio, "Istio Service Mesh", "Service mesh for microservices communication and security")

' Customer Interactions
Rel(customer, loan_system, "Applies for loans, makes payments, views account status", "HTTPS/REST API/GraphQL")
Rel(loan_system, customer, "Sends notifications, loan decisions, payment reminders", "Email/SMS/Push/WebSocket")

' Staff Interactions
Rel(loan_officer, loan_system, "Reviews applications, makes decisions, manages workflows", "HTTPS/REST API/Zero Trust")
Rel(admin, loan_system, "Configures system, monitors performance, manages users", "HTTPS/Admin API/Zero Trust")
Rel(compliance_officer, loan_system, "Reviews compliance reports, audit trails", "HTTPS/Compliance API/FAPI 2.0")

' Core Banking Integration
Rel(loan_system, core_banking, "Retrieves account data, posts transactions", "SOAP/REST API")
Rel(loan_system, credit_bureau, "Retrieves credit scores and history", "HTTPS/API")
Rel(loan_system, payment_gateway, "Processes payments and transfers", "HTTPS/API")
Rel(loan_system, fraud_detection, "Validates transactions for fraud", "REST API")

' AI & Analytics Integration
Rel(loan_system, openai, "Natural language processing, AI assistance", "HTTPS/REST API")
Rel(loan_system, spring_ai, "AI framework integration", "Spring AI Protocol")
Rel(loan_system, analytics_platform, "Sends business metrics and KPIs", "REST API/ETL")
Rel(loan_system, ml_platform, "Fraud detection, anomaly detection", "REST API/ML Models")

' Compliance & Regulatory Integration
Rel(loan_system, regulatory_reporting, "Submits regulatory reports", "SFTP/API")
Rel(loan_system, audit_system, "Logs audit events and trails", "REST API")
Rel(loan_system, kyc_system, "Validates customer identity", "REST API")

' Infrastructure Integration
Rel(loan_system, notification_service, "Sends customer notifications", "REST API")
Rel(loan_system, document_management, "Stores loan documents", "REST API")
Rel(loan_system, keycloak, "Authenticates users with OAuth 2.1/FAPI 2.0", "OAuth 2.1/DPoP")
Rel(loan_system, ldap, "User directory lookup", "LDAP Protocol")

' Operations Integration
Rel(loan_system, prometheus, "Exports metrics", "Prometheus/HTTP")
Rel(loan_system, grafana, "Metrics visualization", "HTTP/API")
Rel(loan_system, elk_stack, "Centralized logging", "Logstash/HTTP")
Rel(loan_system, backup_system, "Scheduled data backups", "Database Replication")
Rel(loan_system, istio, "Service mesh communication", "Envoy Proxy/mTLS")

' External Dependencies
Rel(core_banking, loan_system, "Real-time balance updates", "WebHook/Event")
Rel(fraud_detection, loan_system, "Fraud alerts and blocks", "WebHook/Event")
Rel(notification_service, customer, "Delivers notifications", "Email/SMS/Push")

@enduml