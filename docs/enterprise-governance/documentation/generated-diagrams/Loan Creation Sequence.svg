<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2843px" preserveAspectRatio="none" style="width:2241px;height:2843px;background:#FFFFFF;" version="1.1" viewBox="0 0 2241 2843" width="2241px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="458.125" style="stroke:#181818;stroke-width:1.0;" width="10" x="430.5" y="125.6953"/><rect fill="#FFFFFF" height="371.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="682.5" y="212.0938"/><rect fill="#FFFFFF" height="87.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="682.5" y="1959.7422"/><rect fill="#FFFFFF" height="144.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="986.5" y="341.625"/><rect fill="#FFFFFF" height="255.9297" style="stroke:#181818;stroke-width:1.0;" width="10" x="986.5" y="829.5547"/><rect fill="#FFFFFF" height="148.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="986.5" y="2302.2031"/><rect fill="#FFFFFF" height="227.9297" style="stroke:#181818;stroke-width:1.0;" width="10" x="1218.5" y="1312.2188"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1218.5" y="1828.3438"/><rect fill="#FFFFFF" height="86.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1476.5" y="370.7578"/><rect fill="#FFFFFF" height="155.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="1476.5" y="858.6875"/><rect fill="#FFFFFF" height="77.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1476.5" y="2331.3359"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1674.5" y="1569.2813"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1674.5" y="1988.875"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1674.5" y="2243.9375"/><rect fill="#FFFFFF" height="79.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1803.5" y="670.8906"/><rect fill="#FFFFFF" height="79.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1803.5" y="1712.8125"/><rect fill="#FFFFFF" height="50.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="2053.5" y="700.0234"/><rect fill="#FFFFFF" height="50.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="2053.5" y="1741.9453"/><rect fill="none" height="1647.25" style="stroke:#000000;stroke-width:1.5;" width="2214.5" x="10" y="501.2891"/><rect fill="none" height="1041.0547" style="stroke:#000000;stroke-width:1.5;" width="2194.5" x="20" y="1100.4844"/><rect fill="none" height="333.4609" style="stroke:#000000;stroke-width:1.5;" width="1730" x="20" y="2205.6719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="90" x2="90" y1="36.2969" y2="2807.9922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="435.5" x2="435.5" y1="36.2969" y2="2807.9922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="687.5" x2="687.5" y1="36.2969" y2="2807.9922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="991" x2="991" y1="36.2969" y2="2807.9922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1223" x2="1223" y1="36.2969" y2="2807.9922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1481.5" x2="1481.5" y1="36.2969" y2="2807.9922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1679" x2="1679" y1="36.2969" y2="2807.9922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1808" x2="1808" y1="36.2969" y2="2807.9922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2058" x2="2058" y1="36.2969" y2="2807.9922"/><rect fill="#4A90E2" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="30" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="37" y="24.9951">Bank Employee</text><rect fill="#4A90E2" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="30" y="2806.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="37" y="2826.9873">Bank Employee</text><rect fill="#F5A623" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="378.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="385.5" y="24.9951">LoanController</text><rect fill="#F5A623" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="378.5" y="2806.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="385.5" y="2826.9873">LoanController</text><rect fill="#7ED321" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="601.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="608.5" y="24.9951">LoanApplicationService</text><rect fill="#7ED321" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="601.5" y="2806.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="608.5" y="2826.9873">LoanApplicationService</text><rect fill="#7ED321" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="207" x="888" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="193" x="895" y="24.9951">CustomerApplicationService</text><rect fill="#7ED321" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="207" x="888" y="2806.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="193" x="895" y="2826.9873">CustomerApplicationService</text><rect fill="#BD10E0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47" x="1200" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="1207" y="24.9951">Loan</text><rect fill="#BD10E0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47" x="1200" y="2806.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="1207" y="2826.9873">Loan</text><rect fill="#BD10E0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="1440.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="1447.5" y="24.9951">Customer</text><rect fill="#BD10E0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="1440.5" y="2806.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="1447.5" y="2826.9873">Customer</text><rect fill="#FF6B6B" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="1619" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="1626" y="24.9951">LoanRepository</text><rect fill="#FF6B6B" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="1619" y="2806.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="1626" y="2826.9873">LoanRepository</text><rect fill="#FF6B6B" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="1750" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="1757" y="24.9951">EventPublisher</text><rect fill="#FF6B6B" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="1750" y="2806.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="1757" y="2826.9873">EventPublisher</text><rect fill="#7ED321" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="1989" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="1996" y="24.9951">LoanCreationSaga</text><rect fill="#7ED321" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="1989" y="2806.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="1996" y="2826.9873">LoanCreationSaga</text><rect fill="#FFFFFF" height="458.125" style="stroke:#181818;stroke-width:1.0;" width="10" x="430.5" y="125.6953"/><rect fill="#FFFFFF" height="371.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="682.5" y="212.0938"/><rect fill="#FFFFFF" height="87.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="682.5" y="1959.7422"/><rect fill="#FFFFFF" height="144.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="986.5" y="341.625"/><rect fill="#FFFFFF" height="255.9297" style="stroke:#181818;stroke-width:1.0;" width="10" x="986.5" y="829.5547"/><rect fill="#FFFFFF" height="148.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="986.5" y="2302.2031"/><rect fill="#FFFFFF" height="227.9297" style="stroke:#181818;stroke-width:1.0;" width="10" x="1218.5" y="1312.2188"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1218.5" y="1828.3438"/><rect fill="#FFFFFF" height="86.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1476.5" y="370.7578"/><rect fill="#FFFFFF" height="155.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="1476.5" y="858.6875"/><rect fill="#FFFFFF" height="77.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1476.5" y="2331.3359"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1674.5" y="1569.2813"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1674.5" y="1988.875"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1674.5" y="2243.9375"/><rect fill="#FFFFFF" height="79.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1803.5" y="670.8906"/><rect fill="#FFFFFF" height="79.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1803.5" y="1712.8125"/><rect fill="#FFFFFF" height="50.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="2053.5" y="700.0234"/><rect fill="#FFFFFF" height="50.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="2053.5" y="1741.9453"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2234.5" x="0" y="66.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="66.8633" y2="66.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="69.8633" y2="69.8633"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="187" x="1023.75" y="56.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="1029.75" y="72.3638">Loan Creation Request</text><polygon fill="#181818" points="418.5,121.6953,428.5,125.6953,418.5,129.6953,422.5,125.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="90.5" x2="424.5" y1="125.6953" y2="125.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="97.5" y="105.4966">POST /api/v1/loans</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266" x="97.5" y="120.6294">{customerId, amount, rate, installments}</text><line style="stroke:#181818;stroke-width:1.0;" x1="440.5" x2="482.5" y1="169.9609" y2="169.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="482.5" x2="482.5" y1="169.9609" y2="182.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="441.5" x2="482.5" y1="182.9609" y2="182.9609"/><polygon fill="#181818" points="451.5,178.9609,441.5,182.9609,451.5,186.9609,447.5,182.9609" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="447.5" y="149.7622">Validate request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="447.5" y="164.895">(amount, rate, installments)</text><polygon fill="#181818" points="670.5,208.0938,680.5,212.0938,670.5,216.0938,674.5,212.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="440.5" x2="676.5" y1="212.0938" y2="212.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="447.5" y="207.0278">createLoan(CreateLoanCommand)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2234.5" x="0" y="240.6602"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="240.6602" y2="240.6602"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="243.6602" y2="243.6602"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="200" x="1017.25" y="230.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="181" x="1023.25" y="246.1606">Business Rule Validation</text><line style="stroke:#181818;stroke-width:1.0;" x1="692.5" x2="734.5" y1="299.4922" y2="299.4922"/><line style="stroke:#181818;stroke-width:1.0;" x1="734.5" x2="734.5" y1="299.4922" y2="312.4922"/><line style="stroke:#181818;stroke-width:1.0;" x1="693.5" x2="734.5" y1="312.4922" y2="312.4922"/><polygon fill="#181818" points="703.5,308.4922,693.5,312.4922,703.5,316.4922,699.5,312.4922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="699.5" y="279.2935">Calculate total amount</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="699.5" y="294.4263">(principal + interest)</text><polygon fill="#181818" points="974.5,337.625,984.5,341.625,974.5,345.625,978.5,341.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="692.5" x2="980.5" y1="341.625" y2="341.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275" x="699.5" y="336.5591">isEligibleForLoan(customerId, totalAmount)</text><polygon fill="#181818" points="1464.5,366.7578,1474.5,370.7578,1464.5,374.7578,1468.5,370.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="996.5" x2="1470.5" y1="370.7578" y2="370.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="1003.5" y="365.6919">hasSufficientCredit(amount)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1486.5" x2="1528.5" y1="415.0234" y2="415.0234"/><line style="stroke:#181818;stroke-width:1.0;" x1="1528.5" x2="1528.5" y1="415.0234" y2="428.0234"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.5" x2="1528.5" y1="428.0234" y2="428.0234"/><polygon fill="#181818" points="1497.5,424.0234,1487.5,428.0234,1497.5,432.0234,1493.5,428.0234" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="1493.5" y="394.8247">Check available credit</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="1493.5" y="409.9575">(creditLimit - usedCredit)</text><polygon fill="#181818" points="1007.5,453.1563,997.5,457.1563,1007.5,461.1563,1003.5,457.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1001.5" x2="1480.5" y1="457.1563" y2="457.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="1013.5" y="452.0903">eligibility result</text><polygon fill="#181818" points="703.5,482.2891,693.5,486.2891,703.5,490.2891,699.5,486.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="697.5" x2="990.5" y1="486.2891" y2="486.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="709.5" y="481.2231">eligibility result</text><path d="M10,501.2891 L74,501.2891 L74,508.4219 L64,518.4219 L10,518.4219 L10,501.2891 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1647.25" style="stroke:#000000;stroke-width:1.5;" width="2214.5" x="10" y="501.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="514.356">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="149" x="89" y="513.4995">[Customer Not Eligible]</text><polygon fill="#181818" points="451.5,535.5547,441.5,539.5547,451.5,543.5547,447.5,539.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="445.5" x2="681.5" y1="539.5547" y2="539.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="457.5" y="534.4888">throw InsufficientCreditException</text><polygon fill="#181818" points="101.5,579.8203,91.5,583.8203,101.5,587.8203,97.5,583.8203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="95.5" x2="434.5" y1="583.8203" y2="583.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="107.5" y="563.6216">400 Bad Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236" x="107.5" y="578.7544">{errorCode: "INSUFFICIENT_CREDIT"}</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="2224.5" y1="592.8203" y2="592.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="123" x="15" y="603.0308">[Customer Eligible]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2234.5" x="0" y="627.1914"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="627.1914" y2="627.1914"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="630.1914" y2="630.1914"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="128" x="1053.25" y="616.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109" x="1059.25" y="632.6919">SAGA Initiation</text><polygon fill="#181818" points="1791.5,666.8906,1801.5,670.8906,1791.5,674.8906,1795.5,670.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="687.5" x2="1797.5" y1="670.8906" y2="670.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="694.5" y="665.8247">publishAsync(LoanApplicationSubmitted)</text><polygon fill="#181818" points="2041.5,696.0234,2051.5,700.0234,2041.5,704.0234,2045.5,700.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1813.5" x2="2047.5" y1="700.0234" y2="700.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="1820.5" y="694.9575">handle(LoanApplicationSubmitted)</text><line style="stroke:#181818;stroke-width:1.0;" x1="2063.5" x2="2105.5" y1="749.2891" y2="749.2891"/><line style="stroke:#181818;stroke-width:1.0;" x1="2105.5" x2="2105.5" y1="749.2891" y2="762.2891"/><line style="stroke:#181818;stroke-width:1.0;" x1="2058.5" x2="2105.5" y1="762.2891" y2="762.2891"/><polygon fill="#181818" points="2068.5,758.2891,2058.5,762.2891,2068.5,766.2891,2064.5,762.2891" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="2070.5" y="729.0903">Start SAGA</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="2070.5" y="744.2231">(store saga state)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2234.5" x="0" y="785.8555"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="785.8555" y2="785.8555"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="788.8555" y2="788.8555"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="156" x="1039.25" y="775.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137" x="1045.25" y="791.356">Credit Reservation</text><polygon fill="#181818" points="974.5,825.5547,984.5,829.5547,974.5,833.5547,978.5,829.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="687.5" x2="980.5" y1="829.5547" y2="829.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256" x="694.5" y="824.4888">reserveCredit(customerId, totalAmount)</text><polygon fill="#181818" points="1464.5,854.6875,1474.5,858.6875,1464.5,862.6875,1468.5,858.6875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="996.5" x2="1470.5" y1="858.6875" y2="858.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="1003.5" y="853.6216">reserveCredit(amount)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1486.5" x2="1528.5" y1="887.8203" y2="887.8203"/><line style="stroke:#181818;stroke-width:1.0;" x1="1528.5" x2="1528.5" y1="887.8203" y2="900.8203"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.5" x2="1528.5" y1="900.8203" y2="900.8203"/><polygon fill="#181818" points="1497.5,896.8203,1487.5,900.8203,1497.5,904.8203,1493.5,900.8203" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="1493.5" y="882.7544">Validate sufficient credit</text><line style="stroke:#181818;stroke-width:1.0;" x1="1486.5" x2="1528.5" y1="929.9531" y2="929.9531"/><line style="stroke:#181818;stroke-width:1.0;" x1="1528.5" x2="1528.5" y1="929.9531" y2="942.9531"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.5" x2="1528.5" y1="942.9531" y2="942.9531"/><polygon fill="#181818" points="1497.5,938.9531,1487.5,942.9531,1497.5,946.9531,1493.5,942.9531" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="1493.5" y="924.8872">Update usedCreditLimit</text><line style="stroke:#181818;stroke-width:1.0;" x1="1486.5" x2="1528.5" y1="972.0859" y2="972.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="1528.5" x2="1528.5" y1="972.0859" y2="985.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.5" x2="1528.5" y1="985.0859" y2="985.0859"/><polygon fill="#181818" points="1497.5,981.0859,1487.5,985.0859,1497.5,989.0859,1493.5,985.0859" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="1493.5" y="967.02">raiseEvent(CreditReserved)</text><polygon fill="#181818" points="1007.5,1010.2188,997.5,1014.2188,1007.5,1018.2188,1003.5,1014.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1001.5" x2="1480.5" y1="1014.2188" y2="1014.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="1013.5" y="1009.1528">reservation success</text><line style="stroke:#181818;stroke-width:1.0;" x1="996.5" x2="1038.5" y1="1043.3516" y2="1043.3516"/><line style="stroke:#181818;stroke-width:1.0;" x1="1038.5" x2="1038.5" y1="1043.3516" y2="1056.3516"/><line style="stroke:#181818;stroke-width:1.0;" x1="997.5" x2="1038.5" y1="1056.3516" y2="1056.3516"/><polygon fill="#181818" points="1007.5,1052.3516,997.5,1056.3516,1007.5,1060.3516,1003.5,1056.3516" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="1003.5" y="1038.2856">Save customer &amp; publish events</text><polygon fill="#181818" points="698.5,1081.4844,688.5,1085.4844,698.5,1089.4844,694.5,1085.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="692.5" x2="990.5" y1="1085.4844" y2="1085.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="704.5" y="1080.4185">reservation result</text><path d="M20,1100.4844 L84,1100.4844 L84,1107.6172 L74,1117.6172 L20,1117.6172 L20,1100.4844 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1041.0547" style="stroke:#000000;stroke-width:1.5;" width="2194.5" x="20" y="1100.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="35" y="1113.5513">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="173" x="99" y="1112.6948">[Credit Reservation Failed]</text><polygon fill="#181818" points="446.5,1134.75,436.5,1138.75,446.5,1142.75,442.5,1138.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440.5" x2="686.5" y1="1138.75" y2="1138.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="452.5" y="1133.6841">throw InsufficientCreditException</text><polygon fill="#181818" points="101.5,1179.0156,91.5,1183.0156,101.5,1187.0156,97.5,1183.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="95.5" x2="434.5" y1="1183.0156" y2="1183.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="107.5" y="1162.8169">400 Bad Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236" x="107.5" y="1177.9497">{errorCode: "INSUFFICIENT_CREDIT"}</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="2214.5" y1="1192.0156" y2="1192.0156"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="196" x="25" y="1202.2261">[Credit Reserved Successfully]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2234.5" x="0" y="1226.3867"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="1226.3867" y2="1226.3867"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="1229.3867" y2="1229.3867"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="121" x="1056.75" y="1215.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="1062.75" y="1231.8872">Loan Creation</text><line style="stroke:#181818;stroke-width:1.0;" x1="687.5" x2="729.5" y1="1270.0859" y2="1270.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="729.5" x2="729.5" y1="1270.0859" y2="1283.0859"/><line style="stroke:#181818;stroke-width:1.0;" x1="688.5" x2="729.5" y1="1283.0859" y2="1283.0859"/><polygon fill="#181818" points="698.5,1279.0859,688.5,1283.0859,698.5,1287.0859,694.5,1283.0859" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="694.5" y="1265.02">Generate LoanId</text><polygon fill="#181818" points="1206.5,1308.2188,1216.5,1312.2188,1206.5,1316.2188,1210.5,1312.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="687.5" x2="1212.5" y1="1312.2188" y2="1312.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="339" x="694.5" y="1307.1528">new Loan(id, customerId, amount, installments, rate)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1228.5" x2="1270.5" y1="1341.3516" y2="1341.3516"/><line style="stroke:#181818;stroke-width:1.0;" x1="1270.5" x2="1270.5" y1="1341.3516" y2="1354.3516"/><line style="stroke:#181818;stroke-width:1.0;" x1="1229.5" x2="1270.5" y1="1354.3516" y2="1354.3516"/><polygon fill="#181818" points="1239.5,1350.3516,1229.5,1354.3516,1239.5,1358.3516,1235.5,1354.3516" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="1235.5" y="1336.2856">Validate business rules</text><line style="stroke:#181818;stroke-width:1.0;" x1="1228.5" x2="1270.5" y1="1398.6172" y2="1398.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="1270.5" x2="1270.5" y1="1398.6172" y2="1411.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="1229.5" x2="1270.5" y1="1411.6172" y2="1411.6172"/><polygon fill="#181818" points="1239.5,1407.6172,1229.5,1411.6172,1239.5,1415.6172,1235.5,1411.6172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="1235.5" y="1378.4185">Calculate total amount</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="1235.5" y="1393.5513">(principal &#215; (1 + rate))</text><line style="stroke:#181818;stroke-width:1.0;" x1="1228.5" x2="1270.5" y1="1455.8828" y2="1455.8828"/><line style="stroke:#181818;stroke-width:1.0;" x1="1270.5" x2="1270.5" y1="1455.8828" y2="1468.8828"/><line style="stroke:#181818;stroke-width:1.0;" x1="1229.5" x2="1270.5" y1="1468.8828" y2="1468.8828"/><polygon fill="#181818" points="1239.5,1464.8828,1229.5,1468.8828,1239.5,1472.8828,1235.5,1468.8828" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="1235.5" y="1435.6841">Generate installment schedule</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234" x="1235.5" y="1450.8169">(equal amounts, monthly due dates)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1228.5" x2="1270.5" y1="1498.0156" y2="1498.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="1270.5" x2="1270.5" y1="1498.0156" y2="1511.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="1229.5" x2="1270.5" y1="1511.0156" y2="1511.0156"/><polygon fill="#181818" points="1239.5,1507.0156,1229.5,1511.0156,1239.5,1515.0156,1235.5,1511.0156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="1235.5" y="1492.9497">raiseEvent(LoanCreated)</text><polygon fill="#181818" points="698.5,1536.1484,688.5,1540.1484,698.5,1544.1484,694.5,1540.1484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="692.5" x2="1222.5" y1="1540.1484" y2="1540.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="704.5" y="1535.0825">loan instance</text><polygon fill="#181818" points="1662.5,1565.2813,1672.5,1569.2813,1662.5,1573.2813,1666.5,1569.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="687.5" x2="1668.5" y1="1569.2813" y2="1569.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="694.5" y="1564.2153">save(loan)</text><polygon fill="#181818" points="698.5,1594.4141,688.5,1598.4141,698.5,1602.4141,694.5,1598.4141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="692.5" x2="1678.5" y1="1598.4141" y2="1598.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="704.5" y="1593.3481">saved loan</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2234.5" x="0" y="1626.9805"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="1626.9805" y2="1626.9805"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="1629.9805" y2="1629.9805"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="142" x="1046.25" y="1616.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="123" x="1052.25" y="1632.481">Event Publishing</text><line style="stroke:#181818;stroke-width:1.0;" x1="687.5" x2="729.5" y1="1670.6797" y2="1670.6797"/><line style="stroke:#181818;stroke-width:1.0;" x1="729.5" x2="729.5" y1="1670.6797" y2="1683.6797"/><line style="stroke:#181818;stroke-width:1.0;" x1="688.5" x2="729.5" y1="1683.6797" y2="1683.6797"/><polygon fill="#181818" points="698.5,1679.6797,688.5,1683.6797,698.5,1687.6797,694.5,1683.6797" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="694.5" y="1665.6138">Get domain events from loan</text><polygon fill="#181818" points="1791.5,1708.8125,1801.5,1712.8125,1791.5,1716.8125,1795.5,1712.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="687.5" x2="1797.5" y1="1712.8125" y2="1712.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="694.5" y="1707.7466">publishAsync(LoanCreated)</text><polygon fill="#181818" points="2041.5,1737.9453,2051.5,1741.9453,2041.5,1745.9453,2045.5,1741.9453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1813.5" x2="2047.5" y1="1741.9453" y2="1741.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="1820.5" y="1736.8794">handle(LoanCreated)</text><line style="stroke:#181818;stroke-width:1.0;" x1="2063.5" x2="2105.5" y1="1791.2109" y2="1791.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="2105.5" x2="2105.5" y1="1791.2109" y2="1804.2109"/><line style="stroke:#181818;stroke-width:1.0;" x1="2058.5" x2="2105.5" y1="1804.2109" y2="1804.2109"/><polygon fill="#181818" points="2068.5,1800.2109,2058.5,1804.2109,2068.5,1808.2109,2064.5,1804.2109" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="2070.5" y="1771.0122">Complete SAGA</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="2070.5" y="1786.145">(mark as successful)</text><polygon fill="#181818" points="1206.5,1824.3438,1216.5,1828.3438,1206.5,1832.3438,1210.5,1828.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="687.5" x2="1212.5" y1="1828.3438" y2="1828.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="694.5" y="1823.2778">clearDomainEvents()</text><polygon fill="#181818" points="446.5,1883.4766,436.5,1887.4766,446.5,1891.4766,442.5,1887.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440.5" x2="686.5" y1="1887.4766" y2="1887.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="452.5" y="1882.4106">loanId</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2234.5" x="0" y="1916.043"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="1916.043" y2="1916.043"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="1919.043" y2="1919.043"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="91" x="1071.75" y="1905.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72" x="1077.75" y="1921.5435">Response</text><polygon fill="#181818" points="670.5,1955.7422,680.5,1959.7422,670.5,1963.7422,674.5,1959.7422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="435.5" x2="676.5" y1="1959.7422" y2="1959.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="442.5" y="1954.6763">getLoan(loanId)</text><polygon fill="#181818" points="1662.5,1984.875,1672.5,1988.875,1662.5,1992.875,1666.5,1988.875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="692.5" x2="1668.5" y1="1988.875" y2="1988.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="699.5" y="1983.8091">findById(loanId)</text><polygon fill="#181818" points="703.5,2014.0078,693.5,2018.0078,703.5,2022.0078,699.5,2018.0078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="697.5" x2="1678.5" y1="2018.0078" y2="2018.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="709.5" y="2012.9419">loan</text><polygon fill="#181818" points="446.5,2043.1406,436.5,2047.1406,446.5,2051.1406,442.5,2047.1406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440.5" x2="686.5" y1="2047.1406" y2="2047.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="452.5" y="2042.0747">loan details</text><line style="stroke:#181818;stroke-width:1.0;" x1="435.5" x2="477.5" y1="2076.2734" y2="2076.2734"/><line style="stroke:#181818;stroke-width:1.0;" x1="477.5" x2="477.5" y1="2076.2734" y2="2089.2734"/><line style="stroke:#181818;stroke-width:1.0;" x1="436.5" x2="477.5" y1="2089.2734" y2="2089.2734"/><polygon fill="#181818" points="446.5,2085.2734,436.5,2089.2734,446.5,2093.2734,442.5,2089.2734" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="442.5" y="2071.2075">Convert to LoanResponse DTO</text><polygon fill="#181818" points="101.5,2129.5391,91.5,2133.5391,101.5,2137.5391,97.5,2133.5391" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="95.5" x2="434.5" y1="2133.5391" y2="2133.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="107.5" y="2113.3403">201 Created</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="321" x="107.5" y="2128.4731">LoanResponse{loanId, totalAmount, installments}</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2234.5" x="0" y="2176.1055"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="2176.1055" y2="2176.1055"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2234.5" y1="2179.1055" y2="2179.1055"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="262" x="986.25" y="2165.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="243" x="992.25" y="2181.606">Error Handling (Alternative Flow)</text><path d="M20,2205.6719 L222,2205.6719 L222,2212.8047 L212,2222.8047 L20,2222.8047 L20,2205.6719 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="333.4609" style="stroke:#000000;stroke-width:1.5;" width="1730" x="20" y="2205.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="157" x="35" y="2218.7388">Loan Creation Failure</text><polygon fill="#181818" points="1662.5,2239.9375,1672.5,2243.9375,1662.5,2247.9375,1666.5,2243.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="687.5" x2="1668.5" y1="2243.9375" y2="2243.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="694.5" y="2238.8716">save(loan) throws Exception</text><polygon fill="#181818" points="698.5,2269.0703,688.5,2273.0703,698.5,2277.0703,694.5,2273.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="692.5" x2="1678.5" y1="2273.0703" y2="2273.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="704.5" y="2268.0044">DatabaseException</text><polygon fill="#181818" points="974.5,2298.2031,984.5,2302.2031,974.5,2306.2031,978.5,2302.2031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="687.5" x2="980.5" y1="2302.2031" y2="2302.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255" x="694.5" y="2297.1372">releaseCredit(customerId, totalAmount)</text><polygon fill="#181818" points="1464.5,2327.3359,1474.5,2331.3359,1464.5,2335.3359,1468.5,2331.3359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="996.5" x2="1470.5" y1="2331.3359" y2="2331.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="1003.5" y="2326.27">releaseCredit(amount)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1486.5" x2="1528.5" y1="2360.4688" y2="2360.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="1528.5" x2="1528.5" y1="2360.4688" y2="2373.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="1487.5" x2="1528.5" y1="2373.4688" y2="2373.4688"/><polygon fill="#181818" points="1497.5,2369.4688,1487.5,2373.4688,1497.5,2377.4688,1493.5,2373.4688" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="1493.5" y="2355.4028">Decrease usedCreditLimit</text><line style="stroke:#181818;stroke-width:1.0;" x1="1486.5" x2="1528.5" y1="2407.6016" y2="2407.6016"/><line style="stroke:#181818;stroke-width:1.0;" x1="1528.5" x2="1528.5" y1="2407.6016" y2="2420.6016"/><line style="stroke:#181818;stroke-width:1.0;" x1="1481.5" x2="1528.5" y1="2420.6016" y2="2420.6016"/><polygon fill="#181818" points="1491.5,2416.6016,1481.5,2420.6016,1491.5,2424.6016,1487.5,2420.6016" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="1493.5" y="2402.5356">raiseEvent(CreditReleased)</text><line style="stroke:#181818;stroke-width:1.0;" x1="996.5" x2="1038.5" y1="2449.7344" y2="2449.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="1038.5" x2="1038.5" y1="2449.7344" y2="2462.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="991.5" x2="1038.5" y1="2462.7344" y2="2462.7344"/><polygon fill="#181818" points="1001.5,2458.7344,991.5,2462.7344,1001.5,2466.7344,997.5,2462.7344" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="1003.5" y="2444.6685">Save customer &amp; publish events</text><polygon fill="#181818" points="446.5,2482.8672,436.5,2486.8672,446.5,2490.8672,442.5,2486.8672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="440.5" x2="686.5" y1="2486.8672" y2="2486.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="452.5" y="2481.8013">throw BusinessException</text><polygon fill="#181818" points="101.5,2527.1328,91.5,2531.1328,101.5,2535.1328,97.5,2531.1328" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="95.5" x2="434.5" y1="2531.1328" y2="2531.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="107.5" y="2510.9341">500 Internal Server Error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="107.5" y="2526.0669">{errorCode: "BUSINESS_ERROR"}</text><path d="M28,2551.1328 L28,2682.1328 L2121,2682.1328 L2121,2561.1328 L2111,2551.1328 L28,2551.1328 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2111,2551.1328 L2111,2561.1328 L2121,2561.1328 L2111,2551.1328 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="218" x="909" y="2568.1997">Key Business Rules Enforced:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="909" y="2583.3325">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290" x="909" y="2598.4653">1. Interest rate: 0.1 &#8804; rate &#8804; 0.5 (10% - 50%)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274" x="909" y="2613.5981">2. Installments: Only 6, 9, 12, or 24 allowed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320" x="909" y="2628.731">3. Credit validation: totalAmount &#8804; availableCredit</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286" x="909" y="2643.8638">4. Equal installments with monthly due dates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="284" x="909" y="2658.9966">5. First installment due on 1st of next month</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="322" x="909" y="2674.1294">6. Atomic credit reservation with rollback on failure</text><path d="M1948,2692.1953 L1948,2792.1953 L2168,2792.1953 L2168,2702.1953 L2158,2692.1953 L1948,2692.1953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2158,2692.1953 L2158,2702.1953 L2168,2702.1953 L2158,2692.1953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105" x="1954" y="2709.2622">SAGA Pattern:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1954" y="2724.395">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="1954" y="2739.5278">Ensures distributed transaction</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="1954" y="2754.6606">consistency across Customer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="1954" y="2769.7935">and Loan contexts with proper</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="1954" y="2784.9263">compensation on failures</text><!--SRC=[tLZhRjis5Fwlf-0oTB2nDBNJ94EDfe1iovsnB0viPxyA5BH4EqHeIYCffqRH1zWJx0Ns9dkJFSaEgHkjIwnYsvy52629FD-v7txKDm5PKqwGErhEvXz7ivlP77rxuRxfUUVED-dQQ7QxdCzkRhnym-JIlJf_dMzmx-vkfYDtEPtTPZj-yCQlp_lvZl7iPtUQBmx7_PxNonUdjvEvkrZExqVB-xcNwvXS3Q-6ZXDXeQXF8ymLEXbY_eYyRSJ2FI4d2ClymVRWKEOcn7mKSYL2neWmGiLZnRcgh1j5ZFfOqP0lYDXHFr6ibzBdQW0EKKQnLE6MY0QaRBabcbQSM-1kDe9ii3eCSRtw0sLj1BM2EOb2ILKezhbE_QesQOVItevmTHUl69KFgVBiLGjfapL1ac3X3JRo-aTDU9phQsCOoWJGdFmQ4wdGzRNZv1NoyfsT-06wcosMw1MEwAjT_nK3UVc1V_RJ-4o3KuItOSpLAH8GfbD4kLIOiIsu8Byus5TqfyDNG3gE1LzMzWjcDD3xHMBQ1zvfXk-MeUnY6o1Vkqdqkyue_paAjrlCWsvXcILaGZIC9RIRb6WUCv8PfAEbesHhg2WSOUR7J6Eg48nC0mCkH89odJ66lWS7517WMRS2LYxm0QBIOtH3LunCGc4SiUDkbBX6X-LE2GL2L8ArD1NLFK0FM2xYzHeg2q8ByGgeIaDV0vuB5l05LeE2qGFn7n7UOSemUAJJ0peWEicF6xgb2hr4iIH1ehvRXrqR9sAYH1bLUoWS6JFb1AIDqNbCAhbi1va76JELlqIteK9PuXm4VmU9BfUyUX3X4vfoMOg-zyadaIuy0s4NEY3atJf05xqU6k8WQsPeJY94A4PXG0ReP7gxk9zCfgEfTxlyE9fxu-dov8j1jDonMw2qPFKjORBml71Gzyp2VU-22rJHnbR9Xze0HScqS-MU-vtosH6le0uKiJiq4tLo3C0pGqwNBGyOQOEY1HmZLKWl50nJOptK8JWc299w1MQC8bqxuqRQUivjqkud2OCCIF2tCGBLkXL6WAJTzj_rzg6UVxMhyu5Tb6_QsUqnxYE3K7I-cGNjvGMcafY4T1Bv914w-wr7YB1o9sFVXmFWQsT87Um2xs3IPJtpNLRwY6XhPOivPDlLTWvLgt42GvS4_xjPP3jA0hH8yhQE6TlNi9sZv_Txmed8R9W6jRljkkFaoRphKEZOEaPaavM4m9HuXrLEX-0rsl9EMsK4HG11aSS5Mz2IFtz7dJwG4sDYzpXa7YdBGoJz1nA0IO0CwSyLWUTRIDm3swCW9aYx85kei9ew9xcceqkIbIngYfhOnQ64IfLL2dWfkOQo3-08s96EXYbbIoyx-RwgPYqN6FrbjKPILwHn2ALqd_9Dcw9KA0YtcF9qQA2r2BU9bgyuOlFurPnWpn-hLScwanHuTSI8NamEqoqMZ_ek8lEUh1wdzUVfaQRp6S5YR09YP6IdiQTQvhuy15dI_GqpIMSH9auKSfX0EdlFNK4sH9a1aK0sN3gQ2n7k_S5mFmtgvO-LOsCX7lKUXgw24qCsnk2P6nmyx0YGAXMc2jDGZPSpf_dWEE_rKLfe7xWjzpbn_O0HbI-PzKU4GtXW_atVwMC8_QYhMdTTnsLm2-DmBi3nF67XKzUaSYF2E2gT6lheZ4KDZsyO6SaP2fVuWoEpceGCho5vOwpm2iC4F82fowP-NsTT7SU1tf57wUQ1lMM6OSx_jgpJLeUVGozQqyO_Ilp6HD_nPPKwVXLA3NqqXWVT2W5vrjn_GWGR5DbHRylUikyNRJdR9N2sAJVjm936rfSxtIubzZQyNqnllSNYepUVp-P0t4nlyH3C3OrC2dcQ37UjzEtgtKzaV_X51Jg3hqFXas3mzjNgNU5Q_omnGt-GqjnYW7fdVVJNRt-O9_EZTtO9FANt0hq4gryawJdNOiKq6A0P1wPnTOhUdAB- -Ic2jZ-_GB0SFgKC-FLPnXnt-SUTWTq2HbV-eIBPQoGlpf1dc8qzVz0JLGzLYcC4Bi_GX0fmoEP9UWiCbZwy3jT08Z-fHDf8N9qX5r9F_VGMTN01C9fq5bVOVzGOwtGuGIgGpeIT3piBvdv-XvNESYdi7f1zq842AfMWgnWcC582SwcBCIqU7oOnB1Fkxw5tHIYB3wH9FuDwCpLXem9_qfX48epI7JxG0mAOnet2S5bO_ZS0]--></g></svg>